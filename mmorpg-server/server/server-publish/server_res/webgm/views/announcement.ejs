<%- include new_header %>
    <script type="text/javascript">
    function announcement_del(tr_id, id) {
        var that = this;
        console.log(id);
        $.ajax({
            type: "POST",
            url: "/announcement_del",
            dataType: "json",
            data: {id: id},
            success: function(res) {
                console.log(111);
                if (res.error) {
                    return duihua(res.error);
                }

                duihua('删除成功');

                console.log(tr_id);
                $('#'+tr_id).remove();
            }
        });
    }
    </script>
    <body id="contentBody" onload="">
        <%- include main_side %>

        <div class="container-fluid">
        <h3 class="page-header" id="frame_title">游戏管理--公告查询</h3>

        <div class="dash_board_row_item_left panel panel-default">
            <div class="panel-heading">
                查询
            </div>
            <div class="panel-body">
                <div class="table-responsive">
                    <div class="panel-body">
                        <form method="post" action="/query_announcement">
                            <button type="submit" formmethod="post">查询</button>
                        </form>

                        <table cellspacing="0" rules="all" class="table table-striped table-bordered table-hover" rules="none" id="player_list" style="border-width:0px;width:99%;border-collapse:collapse;">
                            <tr class="thead" style="font-weight:bold;">
                                <td style="white-space:nowrap;">公告id</td>
                                <td style="white-space:nowrap;">开始时间</td>
                                <td style="white-space:nowrap;">间隔时间(秒)</td>
                                <td style="white-space:nowrap;">重复次数</td>
                                <td style="white-space:nowrap;">内容</td>
                                <td style="white-space:nowrap;">操作</td>
                            </tr>
                            <% if (announcements != null) { %>
                                <% announcements.forEach(function(info, index) { %>
                                    <tr id="anounce_<%= info.id %>" style='cursor:hand;'>
                                        <td><%= info.id %></td>
                                        <td><%= info.time %></td>
                                        <td><%= info.interval %></td>
                                        <td><%= info.repeattimes %></td>
                                        <td><%= info.content %></td>
                                        <td>
                                            <button onclick=announcement_del("anounce_<%= info.id %>","<%= info.id %>")>删除</button>
                                        </td>
                                    </tr>
                                <% }) %>
                            <% } %>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<%- include new_footer %>